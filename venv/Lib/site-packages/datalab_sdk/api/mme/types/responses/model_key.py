from marshmallow_dataclass import dataclass
from datalab_sdk.api.common.schema import CamelCaseSchema


@dataclass(base_schema=CamelCaseSchema)
class ModelKey:
    business_domain: str
    business_key: str
    version: str

    def __str__(self) -> str:
        return self.business_domain.upper() + "/" + self.business_key.upper() + "/" + self.version.upper()

    def __eq__(self, other):
        if isinstance(other, self.__class__):
            return (
                self.business_key.lower() == other.business_key.lower()
                and self.business_domain.lower() == other.business_domain.lower()
                and self.version.lower() == other.version.lower()
            )
        else:
            return False

    def __ne__(self, other):
        return not self.__eq__(other)

    def __hash__(self):
        return hash("{}.{}.{}".format(self.business_domain,self.business_key,self.version))
