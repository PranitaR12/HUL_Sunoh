from datalab_sdk.api.common.schema import *

class PermissiveCamelCaseSchema(CamelCaseSchema):
    @marshmallow.pre_load
    def change_naming_convention(self, in_data, **kwargs):
        return upper_camel_case_dict_keys(in_data)

# We need this schema as the key value facet has "from" as one of the properties, which is a keyword in python
class KeyValueFacetFromToSchema(CamelCaseSchema):
    def on_bind_field(self, field_name, field_obj):
        name = field_obj.data_key or field_name
        if name == "facet_from":
            field_obj.data_key = "From"
        if name == "facet_to":
            field_obj.data_key = "To"